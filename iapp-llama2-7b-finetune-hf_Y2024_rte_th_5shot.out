The following values were not passed to `accelerate launch` and had defaults used instead:
	`--num_processes` was set to a value of `2`
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--num_machines` was set to a value of `1`
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
Using RTX 3090 or 4000 series which doesn't support faster communication speedups. Ensuring P2P and IB communications are disabled.
2024-02-08:15:52:58,314 INFO     [config.py:58] PyTorch version 2.1.2 available.
2024-02-08:15:52:58,318 INFO     [config.py:58] PyTorch version 2.1.2 available.
2024-02-08:15:53:00,672 INFO     [__main__.py:156] Verbosity set to INFO
2024-02-08:15:53:00,684 INFO     [__main__.py:156] Verbosity set to INFO
2024-02-08:15:53:02,424 WARNING  [__init__.py:195] Some tasks could not be loaded due to missing dependencies. Run with `--verbosity DEBUG` for full details.
2024-02-08:15:53:02,484 WARNING  [__init__.py:195] Some tasks could not be loaded due to missing dependencies. Run with `--verbosity DEBUG` for full details.
2024-02-08:15:53:04,114 WARNING  [__init__.py:195] Some tasks could not be loaded due to missing dependencies. Run with `--verbosity DEBUG` for full details.
2024-02-08:15:53:04,115 WARNING  [__main__.py:213] File already exists at output/rte_th/iapp-llama2-7b-finetune-hf. Results will be overwritten.
2024-02-08:15:53:04,115 INFO     [__main__.py:229] Selected Tasks: ['rte_th']
2024-02-08:15:53:04,204 WARNING  [__init__.py:195] Some tasks could not be loaded due to missing dependencies. Run with `--verbosity DEBUG` for full details.
2024-02-08:15:53:04,205 WARNING  [__main__.py:213] File already exists at output/rte_th/iapp-llama2-7b-finetune-hf. Results will be overwritten.
2024-02-08:15:53:04,205 INFO     [__main__.py:229] Selected Tasks: ['rte_th']
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.31it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.13it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.33it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.18it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.46it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.42it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-02-08:15:53:06,488 WARNING  [task.py:603] [Task: rte_th] metric acc is defined, but aggregation is not. using default aggregation=mean
2024-02-08:15:53:06,488 WARNING  [task.py:615] [Task: rte_th] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.46it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.36it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-02-08:15:53:06,604 INFO     [huggingface.py:299] Using 2 devices with data parallelism
2024-02-08:15:53:06,604 WARNING  [task.py:603] [Task: rte_th] metric acc is defined, but aggregation is not. using default aggregation=mean
2024-02-08:15:53:06,604 WARNING  [task.py:615] [Task: rte_th] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
2024-02-08:15:53:10,783 WARNING  [evaluator.py:141] Overwriting default num_fewshot of rte_th from None to 5
2024-02-08:15:53:10,783 INFO     [task.py:340] Building contexts for task on rank 1...
2024-02-08:15:53:10,875 WARNING  [evaluator.py:141] Overwriting default num_fewshot of rte_th from None to 5
2024-02-08:15:53:10,875 INFO     [task.py:340] Building contexts for task on rank 0...
2024-02-08:15:53:14,274 INFO     [evaluator.py:319] Running loglikelihood requests
2024-02-08:15:53:14,274 INFO     [evaluator.py:319] Running loglikelihood requests
  0%|          | 0/2970 [00:00<?, ?it/s]Passed argument batch_size = auto:1. Detecting largest batch size
Passed argument batch_size = auto:1. Detecting largest batch size
Determined largest batch size: 8
Determined largest batch size: 8
  0%|          | 1/2970 [00:12<10:02:00, 12.17s/it]  0%|          | 9/2970 [00:12<52:20,  1.06s/it]     1%|          | 17/2970 [00:13<24:59,  1.97it/s]  1%|          | 25/2970 [00:14<15:39,  3.14it/s]  1%|          | 33/2970 [00:14<11:07,  4.40it/s]  1%|▏         | 41/2970 [00:15<08:35,  5.68it/s]  2%|▏         | 49/2970 [00:16<07:02,  6.91it/s]  2%|▏         | 57/2970 [00:16<05:58,  8.13it/s]  2%|▏         | 65/2970 [00:17<05:15,  9.21it/s]  2%|▏         | 73/2970 [00:18<04:45, 10.16it/s]  3%|▎         | 81/2970 [00:18<04:24, 10.93it/s]  3%|▎         | 89/2970 [00:19<04:09, 11.54it/s]  3%|▎         | 97/2970 [00:19<03:59, 12.01it/s]  4%|▎         | 105/2970 [00:20<03:51, 12.37it/s]  4%|▍         | 113/2970 [00:21<03:46, 12.64it/s]  4%|▍         | 121/2970 [00:21<03:41, 12.84it/s]  4%|▍         | 129/2970 [00:22<03:38, 13.00it/s]  5%|▍         | 137/2970 [00:22<03:34, 13.20it/s]  5%|▍         | 145/2970 [00:23<03:31, 13.35it/s]  5%|▌         | 153/2970 [00:24<03:29, 13.46it/s]  5%|▌         | 161/2970 [00:24<03:27, 13.54it/s]  6%|▌         | 169/2970 [00:25<03:25, 13.60it/s]  6%|▌         | 177/2970 [00:25<03:24, 13.65it/s]  6%|▌         | 185/2970 [00:26<03:23, 13.69it/s]  6%|▋         | 193/2970 [00:27<03:22, 13.73it/s]  7%|▋         | 201/2970 [00:27<03:21, 13.75it/s]  7%|▋         | 209/2970 [00:28<03:20, 13.78it/s]  7%|▋         | 217/2970 [00:28<03:19, 13.80it/s]  8%|▊         | 225/2970 [00:29<03:18, 13.83it/s]  8%|▊         | 233/2970 [00:29<03:17, 13.85it/s]  8%|▊         | 241/2970 [00:30<03:16, 13.87it/s]  8%|▊         | 249/2970 [00:31<03:15, 13.88it/s]  9%|▊         | 257/2970 [00:31<03:15, 13.90it/s]  9%|▉         | 265/2970 [00:32<03:14, 13.92it/s]  9%|▉         | 273/2970 [00:32<03:12, 14.02it/s]  9%|▉         | 281/2970 [00:33<03:09, 14.15it/s] 10%|▉         | 289/2970 [00:33<03:08, 14.25it/s] 10%|█         | 297/2970 [00:34<03:06, 14.32it/s] 10%|█         | 305/2970 [00:34<03:05, 14.38it/s] 11%|█         | 313/2970 [00:35<03:04, 14.42it/s] 11%|█         | 321/2970 [00:36<03:03, 14.45it/s] 11%|█         | 329/2970 [00:36<03:02, 14.48it/s] 11%|█▏        | 337/2970 [00:37<03:01, 14.50it/s] 12%|█▏        | 345/2970 [00:37<02:57, 14.77it/s] 12%|█▏        | 353/2970 [00:38<02:54, 14.97it/s] 12%|█▏        | 361/2970 [00:38<02:52, 15.12it/s] 12%|█▏        | 369/2970 [00:39<02:50, 15.22it/s] 13%|█▎        | 377/2970 [00:39<02:49, 15.30it/s] 13%|█▎        | 385/2970 [00:40<02:48, 15.36it/s] 13%|█▎        | 393/2970 [00:40<02:47, 15.40it/s] 14%|█▎        | 401/2970 [00:41<02:46, 15.44it/s] 14%|█▍        | 409/2970 [00:41<02:45, 15.47it/s] 14%|█▍        | 417/2970 [00:42<02:44, 15.50it/s] 14%|█▍        | 425/2970 [00:42<02:43, 15.53it/s] 15%|█▍        | 433/2970 [00:43<02:43, 15.55it/s] 15%|█▍        | 441/2970 [00:43<02:42, 15.56it/s] 15%|█▌        | 449/2970 [00:44<02:41, 15.58it/s] 15%|█▌        | 457/2970 [00:44<02:41, 15.59it/s] 16%|█▌        | 465/2970 [00:45<02:40, 15.60it/s] 16%|█▌        | 473/2970 [00:45<02:39, 15.61it/s] 16%|█▌        | 481/2970 [00:46<02:39, 15.62it/s] 16%|█▋        | 489/2970 [00:46<02:38, 15.63it/s] 17%|█▋        | 497/2970 [00:47<02:38, 15.64it/s] 17%|█▋        | 505/2970 [00:47<02:37, 15.65it/s] 17%|█▋        | 513/2970 [00:48<02:36, 15.66it/s] 18%|█▊        | 521/2970 [00:48<02:36, 15.67it/s] 18%|█▊        | 529/2970 [00:49<02:34, 15.80it/s] 18%|█▊        | 537/2970 [00:49<02:33, 15.89it/s] 18%|█▊        | 545/2970 [00:50<02:31, 15.96it/s] 19%|█▊        | 553/2970 [00:50<02:30, 16.01it/s] 19%|█▉        | 561/2970 [00:51<02:30, 16.05it/s] 19%|█▉        | 569/2970 [00:51<02:29, 16.08it/s] 19%|█▉        | 577/2970 [00:52<02:28, 16.10it/s] 20%|█▉        | 585/2970 [00:52<02:27, 16.12it/s] 20%|█▉        | 593/2970 [00:53<02:27, 16.14it/s] 20%|██        | 601/2970 [00:53<02:26, 16.15it/s] 21%|██        | 609/2970 [00:54<02:26, 16.16it/s] 21%|██        | 617/2970 [00:54<02:25, 16.17it/s] 21%|██        | 625/2970 [00:55<02:24, 16.19it/s] 21%|██▏       | 633/2970 [00:55<02:24, 16.19it/s] 22%|██▏       | 641/2970 [00:56<02:23, 16.21it/s] 22%|██▏       | 649/2970 [00:56<02:23, 16.22it/s] 22%|██▏       | 657/2970 [00:57<02:22, 16.24it/s] 22%|██▏       | 665/2970 [00:57<02:21, 16.25it/s] 23%|██▎       | 673/2970 [00:58<02:21, 16.27it/s] 23%|██▎       | 681/2970 [00:58<02:20, 16.28it/s] 23%|██▎       | 689/2970 [00:59<02:20, 16.29it/s] 23%|██▎       | 697/2970 [00:59<02:19, 16.30it/s] 24%|██▎       | 705/2970 [01:00<02:18, 16.31it/s] 24%|██▍       | 713/2970 [01:00<02:18, 16.32it/s] 24%|██▍       | 721/2970 [01:01<02:17, 16.33it/s] 25%|██▍       | 729/2970 [01:01<02:17, 16.33it/s] 25%|██▍       | 737/2970 [01:02<02:16, 16.42it/s] 25%|██▌       | 745/2970 [01:02<02:15, 16.48it/s] 25%|██▌       | 753/2970 [01:03<02:14, 16.52it/s] 26%|██▌       | 761/2970 [01:03<02:13, 16.56it/s] 26%|██▌       | 769/2970 [01:04<02:12, 16.59it/s] 26%|██▌       | 777/2970 [01:04<02:12, 16.61it/s] 26%|██▋       | 785/2970 [01:05<02:11, 16.64it/s] 27%|██▋       | 793/2970 [01:05<02:10, 16.66it/s] 27%|██▋       | 801/2970 [01:06<02:10, 16.67it/s] 27%|██▋       | 809/2970 [01:06<02:09, 16.68it/s] 28%|██▊       | 817/2970 [01:07<02:08, 16.69it/s] 28%|██▊       | 825/2970 [01:07<02:08, 16.71it/s] 28%|██▊       | 833/2970 [01:08<02:07, 16.72it/s] 28%|██▊       | 841/2970 [01:08<02:06, 16.86it/s] 29%|██▊       | 849/2970 [01:08<02:05, 16.96it/s] 29%|██▉       | 857/2970 [01:09<02:04, 17.04it/s] 29%|██▉       | 865/2970 [01:09<02:03, 17.09it/s] 29%|██▉       | 873/2970 [01:10<02:02, 17.13it/s] 30%|██▉       | 881/2970 [01:10<02:01, 17.16it/s] 30%|██▉       | 889/2970 [01:11<02:01, 17.19it/s] 30%|███       | 897/2970 [01:11<02:00, 17.21it/s] 30%|███       | 905/2970 [01:12<01:59, 17.23it/s] 31%|███       | 913/2970 [01:12<01:59, 17.24it/s] 31%|███       | 921/2970 [01:13<01:58, 17.25it/s] 31%|███▏      | 929/2970 [01:13<01:58, 17.26it/s] 32%|███▏      | 937/2970 [01:14<01:57, 17.28it/s] 32%|███▏      | 945/2970 [01:14<01:57, 17.28it/s] 32%|███▏      | 953/2970 [01:14<01:56, 17.29it/s] 32%|███▏      | 961/2970 [01:15<01:56, 17.30it/s] 33%|███▎      | 969/2970 [01:15<01:55, 17.31it/s] 33%|███▎      | 977/2970 [01:16<01:55, 17.31it/s] 33%|███▎      | 985/2970 [01:16<01:54, 17.38it/s] 33%|███▎      | 993/2970 [01:17<01:53, 17.44it/s] 34%|███▎      | 1001/2970 [01:17<01:52, 17.48it/s] 34%|███▍      | 1009/2970 [01:18<01:51, 17.51it/s] 34%|███▍      | 1017/2970 [01:18<01:51, 17.54it/s] 35%|███▍      | 1025/2970 [01:19<01:50, 17.56it/s] 35%|███▍      | 1033/2970 [01:19<01:50, 17.57it/s] 35%|███▌      | 1041/2970 [01:19<01:49, 17.59it/s] 35%|███▌      | 1049/2970 [01:20<01:49, 17.60it/s] 36%|███▌      | 1057/2970 [01:20<01:48, 17.61it/s] 36%|███▌      | 1065/2970 [01:21<01:48, 17.62it/s] 36%|███▌      | 1073/2970 [01:21<01:47, 17.63it/s] 36%|███▋      | 1081/2970 [01:22<01:47, 17.63it/s] 37%|███▋      | 1089/2970 [01:22<01:46, 17.64it/s] 37%|███▋      | 1097/2970 [01:23<01:46, 17.64it/s] 37%|███▋      | 1105/2970 [01:23<01:45, 17.65it/s] 37%|███▋      | 1113/2970 [01:24<01:45, 17.65it/s] 38%|███▊      | 1121/2970 [01:24<01:44, 17.66it/s] 38%|███▊      | 1129/2970 [01:24<01:44, 17.67it/s] 38%|███▊      | 1137/2970 [01:25<01:43, 17.68it/s] 39%|███▊      | 1145/2970 [01:25<01:43, 17.69it/s] 39%|███▉      | 1153/2970 [01:26<01:42, 17.70it/s] 39%|███▉      | 1161/2970 [01:26<01:42, 17.71it/s] 39%|███▉      | 1169/2970 [01:27<01:41, 17.72it/s] 40%|███▉      | 1177/2970 [01:27<01:41, 17.73it/s] 40%|███▉      | 1185/2970 [01:28<01:40, 17.74it/s] 40%|████      | 1193/2970 [01:28<01:40, 17.75it/s] 40%|████      | 1201/2970 [01:29<01:39, 17.75it/s] 41%|████      | 1209/2970 [01:29<01:39, 17.76it/s] 41%|████      | 1217/2970 [01:29<01:38, 17.77it/s] 41%|████      | 1225/2970 [01:30<01:38, 17.77it/s] 42%|████▏     | 1233/2970 [01:30<01:37, 17.78it/s] 42%|████▏     | 1241/2970 [01:31<01:37, 17.79it/s] 42%|████▏     | 1249/2970 [01:31<01:36, 17.79it/s] 42%|████▏     | 1257/2970 [01:32<01:36, 17.80it/s] 43%|████▎     | 1265/2970 [01:32<01:35, 17.81it/s] 43%|████▎     | 1273/2970 [01:33<01:35, 17.82it/s] 43%|████▎     | 1281/2970 [01:33<01:34, 17.83it/s] 43%|████▎     | 1289/2970 [01:33<01:34, 17.84it/s] 44%|████▎     | 1297/2970 [01:34<01:33, 17.85it/s] 44%|████▍     | 1305/2970 [01:34<01:30, 18.38it/s] 44%|████▍     | 1313/2970 [01:35<01:28, 18.77it/s] 44%|████▍     | 1321/2970 [01:35<01:26, 19.04it/s] 45%|████▍     | 1329/2970 [01:36<01:25, 19.25it/s] 45%|████▌     | 1337/2970 [01:36<01:24, 19.39it/s] 45%|████▌     | 1345/2970 [01:36<01:23, 19.49it/s] 46%|████▌     | 1353/2970 [01:37<01:22, 19.57it/s] 46%|████▌     | 1361/2970 [01:37<01:21, 19.63it/s] 46%|████▌     | 1369/2970 [01:38<01:21, 19.67it/s] 46%|████▋     | 1377/2970 [01:38<01:20, 19.70it/s] 47%|████▋     | 1385/2970 [01:38<01:20, 19.73it/s] 47%|████▋     | 1393/2970 [01:39<01:19, 19.75it/s] 47%|████▋     | 1401/2970 [01:39<01:19, 19.77it/s] 47%|████▋     | 1409/2970 [01:40<01:18, 19.78it/s] 48%|████▊     | 1417/2970 [01:40<01:18, 19.79it/s] 48%|████▊     | 1425/2970 [01:40<01:18, 19.80it/s] 48%|████▊     | 1433/2970 [01:41<01:17, 19.81it/s] 49%|████▊     | 1441/2970 [01:41<01:17, 19.81it/s] 49%|████▉     | 1449/2970 [01:42<01:16, 19.82it/s] 49%|████▉     | 1457/2970 [01:42<01:16, 19.83it/s] 49%|████▉     | 1465/2970 [01:42<01:15, 19.84it/s] 50%|████▉     | 1473/2970 [01:43<01:15, 19.85it/s] 50%|████▉     | 1481/2970 [01:43<01:14, 19.88it/s] 50%|█████     | 1489/2970 [01:44<01:14, 19.90it/s] 50%|█████     | 1497/2970 [01:44<01:13, 19.92it/s] 51%|█████     | 1505/2970 [01:44<01:13, 19.93it/s] 51%|█████     | 1513/2970 [01:45<01:13, 19.95it/s] 51%|█████     | 1521/2970 [01:45<01:12, 19.96it/s] 51%|█████▏    | 1529/2970 [01:46<01:12, 19.97it/s] 52%|█████▏    | 1537/2970 [01:46<01:11, 19.98it/s] 52%|█████▏    | 1545/2970 [01:46<01:11, 19.99it/s] 52%|█████▏    | 1553/2970 [01:47<01:10, 20.00it/s] 53%|█████▎    | 1561/2970 [01:47<01:10, 20.01it/s] 53%|█████▎    | 1569/2970 [01:48<01:09, 20.02it/s] 53%|█████▎    | 1577/2970 [01:48<01:09, 20.03it/s] 53%|█████▎    | 1585/2970 [01:48<01:09, 20.04it/s] 54%|█████▎    | 1593/2970 [01:49<01:08, 20.04it/s] 54%|█████▍    | 1601/2970 [01:49<01:08, 20.06it/s] 54%|█████▍    | 1609/2970 [01:50<01:07, 20.06it/s] 54%|█████▍    | 1617/2970 [01:50<01:07, 20.07it/s] 55%|█████▍    | 1625/2970 [01:50<01:06, 20.08it/s] 55%|█████▍    | 1633/2970 [01:51<01:06, 20.09it/s] 55%|█████▌    | 1641/2970 [01:51<01:06, 20.10it/s] 56%|█████▌    | 1649/2970 [01:52<01:05, 20.15it/s] 56%|█████▌    | 1657/2970 [01:52<01:05, 20.18it/s] 56%|█████▌    | 1665/2970 [01:52<01:04, 20.21it/s] 56%|█████▋    | 1673/2970 [01:53<01:04, 20.23it/s] 57%|█████▋    | 1681/2970 [01:53<01:03, 20.25it/s] 57%|█████▋    | 1689/2970 [01:54<01:03, 20.26it/s] 57%|█████▋    | 1697/2970 [01:54<01:02, 20.28it/s] 57%|█████▋    | 1705/2970 [01:54<01:02, 20.29it/s] 58%|█████▊    | 1713/2970 [01:55<01:01, 20.30it/s] 58%|█████▊    | 1721/2970 [01:55<01:01, 20.31it/s] 58%|█████▊    | 1729/2970 [01:56<01:01, 20.32it/s] 58%|█████▊    | 1737/2970 [01:56<01:00, 20.34it/s] 59%|█████▉    | 1745/2970 [01:56<01:00, 20.35it/s] 59%|█████▉    | 1753/2970 [01:57<00:59, 20.36it/s] 59%|█████▉    | 1761/2970 [01:57<00:59, 20.37it/s] 60%|█████▉    | 1769/2970 [01:58<00:58, 20.37it/s] 60%|█████▉    | 1777/2970 [01:58<00:58, 20.38it/s] 60%|██████    | 1785/2970 [01:58<00:58, 20.39it/s] 60%|██████    | 1793/2970 [01:59<00:57, 20.39it/s] 61%|██████    | 1801/2970 [01:59<00:57, 20.40it/s] 61%|██████    | 1809/2970 [01:59<00:56, 20.41it/s] 61%|██████    | 1817/2970 [02:00<00:55, 20.61it/s] 61%|██████▏   | 1825/2970 [02:00<00:55, 20.76it/s] 62%|██████▏   | 1833/2970 [02:01<00:54, 20.85it/s] 62%|██████▏   | 1841/2970 [02:01<00:53, 20.92it/s] 62%|██████▏   | 1849/2970 [02:01<00:53, 20.99it/s] 63%|██████▎   | 1857/2970 [02:02<00:52, 21.02it/s] 63%|██████▎   | 1865/2970 [02:02<00:52, 21.05it/s] 63%|██████▎   | 1873/2970 [02:02<00:52, 21.08it/s] 63%|██████▎   | 1881/2970 [02:03<00:51, 21.11it/s] 64%|██████▎   | 1889/2970 [02:03<00:51, 21.12it/s] 64%|██████▍   | 1897/2970 [02:04<00:50, 21.14it/s] 64%|██████▍   | 1905/2970 [02:04<00:50, 21.16it/s] 64%|██████▍   | 1913/2970 [02:04<00:49, 21.18it/s] 65%|██████▍   | 1921/2970 [02:05<00:49, 21.19it/s] 65%|██████▍   | 1929/2970 [02:05<00:49, 21.21it/s] 65%|██████▌   | 1937/2970 [02:06<00:48, 21.22it/s] 65%|██████▌   | 1945/2970 [02:06<00:48, 21.23it/s] 66%|██████▌   | 1953/2970 [02:06<00:47, 21.23it/s] 66%|██████▌   | 1961/2970 [02:07<00:47, 21.23it/s] 66%|██████▋   | 1969/2970 [02:07<00:47, 21.23it/s] 67%|██████▋   | 1977/2970 [02:07<00:46, 21.23it/s] 67%|██████▋   | 1985/2970 [02:08<00:46, 21.25it/s] 67%|██████▋   | 1993/2970 [02:08<00:45, 21.27it/s] 67%|██████▋   | 2001/2970 [02:09<00:45, 21.27it/s] 68%|██████▊   | 2009/2970 [02:09<00:45, 21.28it/s] 68%|██████▊   | 2017/2970 [02:09<00:44, 21.29it/s] 68%|██████▊   | 2025/2970 [02:10<00:44, 21.31it/s] 68%|██████▊   | 2033/2970 [02:10<00:43, 21.44it/s] 69%|██████▊   | 2041/2970 [02:10<00:43, 21.53it/s] 69%|██████▉   | 2049/2970 [02:11<00:42, 21.57it/s] 69%|██████▉   | 2057/2970 [02:11<00:42, 21.60it/s] 70%|██████▉   | 2065/2970 [02:11<00:41, 21.63it/s] 70%|██████▉   | 2073/2970 [02:12<00:41, 21.64it/s] 70%|███████   | 2081/2970 [02:12<00:41, 21.66it/s] 70%|███████   | 2089/2970 [02:13<00:40, 21.67it/s] 71%|███████   | 2097/2970 [02:13<00:40, 21.68it/s] 71%|███████   | 2105/2970 [02:13<00:39, 21.70it/s] 71%|███████   | 2113/2970 [02:14<00:39, 21.71it/s] 71%|███████▏  | 2121/2970 [02:14<00:39, 21.72it/s] 72%|███████▏  | 2129/2970 [02:14<00:38, 21.72it/s] 72%|███████▏  | 2137/2970 [02:15<00:38, 21.73it/s] 72%|███████▏  | 2145/2970 [02:15<00:37, 21.75it/s] 72%|███████▏  | 2153/2970 [02:16<00:37, 21.76it/s] 73%|███████▎  | 2161/2970 [02:16<00:37, 21.78it/s] 73%|███████▎  | 2169/2970 [02:16<00:36, 21.79it/s] 73%|███████▎  | 2177/2970 [02:17<00:36, 21.80it/s] 74%|███████▎  | 2185/2970 [02:17<00:35, 21.81it/s] 74%|███████▍  | 2193/2970 [02:17<00:35, 21.82it/s] 74%|███████▍  | 2201/2970 [02:18<00:35, 21.82it/s] 74%|███████▍  | 2209/2970 [02:18<00:34, 21.84it/s] 75%|███████▍  | 2217/2970 [02:18<00:34, 21.85it/s] 75%|███████▍  | 2225/2970 [02:19<00:34, 21.87it/s] 75%|███████▌  | 2233/2970 [02:19<00:33, 21.90it/s] 75%|███████▌  | 2241/2970 [02:20<00:33, 21.93it/s] 76%|███████▌  | 2249/2970 [02:20<00:32, 21.94it/s] 76%|███████▌  | 2257/2970 [02:20<00:32, 21.96it/s] 76%|███████▋  | 2265/2970 [02:21<00:32, 21.98it/s] 77%|███████▋  | 2273/2970 [02:21<00:31, 21.99it/s] 77%|███████▋  | 2281/2970 [02:21<00:31, 22.00it/s] 77%|███████▋  | 2289/2970 [02:22<00:30, 22.01it/s] 77%|███████▋  | 2297/2970 [02:22<00:30, 22.02it/s] 78%|███████▊  | 2305/2970 [02:22<00:30, 22.04it/s] 78%|███████▊  | 2313/2970 [02:23<00:29, 22.05it/s] 78%|███████▊  | 2321/2970 [02:23<00:29, 22.07it/s] 78%|███████▊  | 2329/2970 [02:24<00:29, 22.09it/s] 79%|███████▊  | 2337/2970 [02:24<00:28, 22.11it/s] 79%|███████▉  | 2345/2970 [02:24<00:28, 22.12it/s] 79%|███████▉  | 2353/2970 [02:25<00:27, 22.14it/s] 79%|███████▉  | 2361/2970 [02:25<00:27, 22.15it/s] 80%|███████▉  | 2369/2970 [02:25<00:26, 22.49it/s] 80%|████████  | 2377/2970 [02:26<00:26, 22.74it/s] 80%|████████  | 2385/2970 [02:26<00:25, 22.92it/s] 81%|████████  | 2393/2970 [02:26<00:25, 23.05it/s] 81%|████████  | 2401/2970 [02:27<00:24, 23.15it/s] 81%|████████  | 2409/2970 [02:27<00:24, 23.22it/s] 81%|████████▏ | 2417/2970 [02:27<00:23, 23.29it/s] 82%|████████▏ | 2425/2970 [02:28<00:23, 23.32it/s] 82%|████████▏ | 2433/2970 [02:28<00:22, 23.35it/s] 82%|████████▏ | 2441/2970 [02:28<00:22, 23.37it/s] 82%|████████▏ | 2449/2970 [02:29<00:22, 23.39it/s] 83%|████████▎ | 2457/2970 [02:29<00:21, 23.40it/s] 83%|████████▎ | 2465/2970 [02:29<00:21, 23.41it/s] 83%|████████▎ | 2473/2970 [02:30<00:21, 23.43it/s] 84%|████████▎ | 2481/2970 [02:30<00:20, 23.45it/s] 84%|████████▍ | 2489/2970 [02:30<00:20, 23.47it/s] 84%|████████▍ | 2497/2970 [02:31<00:20, 23.49it/s] 84%|████████▍ | 2505/2970 [02:31<00:19, 23.51it/s] 85%|████████▍ | 2513/2970 [02:31<00:19, 23.55it/s] 85%|████████▍ | 2521/2970 [02:32<00:19, 23.57it/s] 85%|████████▌ | 2529/2970 [02:32<00:18, 23.61it/s] 85%|████████▌ | 2537/2970 [02:33<00:18, 23.62it/s] 86%|████████▌ | 2545/2970 [02:33<00:17, 23.64it/s] 86%|████████▌ | 2553/2970 [02:33<00:17, 23.65it/s] 86%|████████▌ | 2561/2970 [02:34<00:17, 23.68it/s] 86%|████████▋ | 2569/2970 [02:34<00:16, 23.68it/s] 87%|████████▋ | 2577/2970 [02:34<00:16, 23.70it/s] 87%|████████▋ | 2585/2970 [02:35<00:16, 23.70it/s] 87%|████████▋ | 2593/2970 [02:35<00:15, 23.72it/s] 88%|████████▊ | 2601/2970 [02:35<00:15, 23.73it/s] 88%|████████▊ | 2609/2970 [02:36<00:15, 23.75it/s] 88%|████████▊ | 2617/2970 [02:36<00:14, 23.76it/s] 88%|████████▊ | 2625/2970 [02:36<00:14, 23.78it/s] 89%|████████▊ | 2633/2970 [02:37<00:14, 23.78it/s] 89%|████████▉ | 2641/2970 [02:37<00:13, 23.80it/s] 89%|████████▉ | 2649/2970 [02:37<00:13, 24.51it/s] 89%|████████▉ | 2657/2970 [02:37<00:12, 25.03it/s] 90%|████████▉ | 2665/2970 [02:38<00:12, 25.40it/s] 90%|█████████ | 2673/2970 [02:38<00:11, 25.69it/s] 90%|█████████ | 2681/2970 [02:38<00:11, 25.91it/s] 91%|█████████ | 2689/2970 [02:39<00:10, 26.06it/s] 91%|█████████ | 2697/2970 [02:39<00:10, 26.15it/s] 91%|█████████ | 2705/2970 [02:39<00:10, 26.26it/s] 91%|█████████▏| 2713/2970 [02:40<00:09, 26.35it/s] 92%|█████████▏| 2721/2970 [02:40<00:09, 26.40it/s] 92%|█████████▏| 2729/2970 [02:40<00:09, 26.43it/s] 92%|█████████▏| 2737/2970 [02:41<00:08, 26.47it/s] 92%|█████████▏| 2745/2970 [02:41<00:08, 26.50it/s] 93%|█████████▎| 2753/2970 [02:41<00:08, 26.86it/s] 93%|█████████▎| 2761/2970 [02:41<00:07, 27.11it/s] 93%|█████████▎| 2769/2970 [02:42<00:07, 27.29it/s] 94%|█████████▎| 2777/2970 [02:42<00:07, 27.45it/s] 94%|█████████▍| 2785/2970 [02:42<00:06, 27.54it/s] 94%|█████████▍| 2793/2970 [02:43<00:06, 27.63it/s] 94%|█████████▍| 2801/2970 [02:43<00:06, 27.70it/s] 95%|█████████▍| 2809/2970 [02:43<00:05, 27.75it/s] 95%|█████████▍| 2817/2970 [02:43<00:05, 27.79it/s] 95%|█████████▌| 2825/2970 [02:44<00:05, 27.85it/s] 95%|█████████▌| 2833/2970 [02:44<00:04, 27.89it/s] 96%|█████████▌| 2841/2970 [02:44<00:04, 27.99it/s] 96%|█████████▌| 2849/2970 [02:45<00:04, 28.08it/s] 96%|█████████▌| 2857/2970 [02:45<00:04, 28.15it/s] 96%|█████████▋| 2865/2970 [02:45<00:03, 28.20it/s] 97%|█████████▋| 2873/2970 [02:45<00:03, 28.26it/s] 97%|█████████▋| 2881/2970 [02:46<00:03, 28.30it/s] 97%|█████████▋| 2889/2970 [02:46<00:02, 28.35it/s] 98%|█████████▊| 2897/2970 [02:46<00:02, 28.37it/s] 98%|█████████▊| 2905/2970 [02:47<00:02, 28.44it/s] 98%|█████████▊| 2913/2970 [02:47<00:01, 28.50it/s] 98%|█████████▊| 2921/2970 [02:47<00:01, 28.56it/s] 99%|█████████▊| 2929/2970 [02:47<00:01, 28.61it/s] 99%|█████████▉| 2937/2970 [02:48<00:01, 28.70it/s] 99%|█████████▉| 2945/2970 [02:48<00:00, 28.73it/s] 99%|█████████▉| 2953/2970 [02:48<00:00, 29.38it/s]100%|█████████▉| 2961/2970 [02:48<00:00, 30.07it/s]100%|██████████| 2970/2970 [02:48<00:00, 17.58it/s]
Traceback (most recent call last):
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/iapp/lm-evaluation-harness/lm_eval/__main__.py", line 286, in <module>
    cli_evaluate()
  File "/home/iapp/lm-evaluation-harness/lm_eval/__main__.py", line 231, in cli_evaluate
    results = evaluator.simple_evaluate(
  File "/home/iapp/lm-evaluation-harness/lm_eval/utils.py", line 415, in _wrapper
    return fn(*args, **kwargs)
  File "/home/iapp/lm-evaluation-harness/lm_eval/evaluator.py", line 150, in simple_evaluate
    results = evaluate(
  File "/home/iapp/lm-evaluation-harness/lm_eval/utils.py", line 415, in _wrapper
    return fn(*args, **kwargs)
  File "/home/iapp/lm-evaluation-harness/lm_eval/evaluator.py", line 373, in evaluate
    metrics = task.process_results(
  File "/home/iapp/lm-evaluation-harness/lm_eval/api/task.py", line 1100, in process_results
    exact_match = int(is_greedy[gold]) if gold != -100 else 0
TypeError: tuple indices must be integers or slices, not NoneType
Traceback (most recent call last):
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/iapp/lm-evaluation-harness/lm_eval/__main__.py", line 286, in <module>
    cli_evaluate()
  File "/home/iapp/lm-evaluation-harness/lm_eval/__main__.py", line 231, in cli_evaluate
    results = evaluator.simple_evaluate(
  File "/home/iapp/lm-evaluation-harness/lm_eval/utils.py", line 415, in _wrapper
    return fn(*args, **kwargs)
  File "/home/iapp/lm-evaluation-harness/lm_eval/evaluator.py", line 150, in simple_evaluate
    results = evaluate(
  File "/home/iapp/lm-evaluation-harness/lm_eval/utils.py", line 415, in _wrapper
    return fn(*args, **kwargs)
  File "/home/iapp/lm-evaluation-harness/lm_eval/evaluator.py", line 373, in evaluate
    metrics = task.process_results(
  File "/home/iapp/lm-evaluation-harness/lm_eval/api/task.py", line 1100, in process_results
    exact_match = int(is_greedy[gold]) if gold != -100 else 0
TypeError: tuple indices must be integers or slices, not NoneType
[2024-02-08 15:56:07,679] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 3322018) of binary: /home/iapp/miniconda3/envs/harness/bin/python
Traceback (most recent call last):
  File "/home/iapp/miniconda3/envs/harness/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/site-packages/accelerate/commands/launch.py", line 1014, in launch_command
    multi_gpu_launcher(args)
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/site-packages/accelerate/commands/launch.py", line 672, in multi_gpu_launcher
    distrib_run.run(args)
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/iapp/miniconda3/envs/harness/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
lm_eval FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-02-08_15:56:07
  host      : gpt3zx
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3322019)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-02-08_15:56:07
  host      : gpt3zx
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3322018)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
